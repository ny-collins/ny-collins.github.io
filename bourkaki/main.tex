\documentclass[12pt, openany]{book}

% --- 1. PACKAGES ---
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath, amssymb, amsthm} % The Math Powerhouse
\usepackage{geometry}
\usepackage[
    hidelinks,
    pdftitle={Foundations of Mathematics: A Rigorous Introduction},
    pdfauthor={Collins Mwangi},
    pdfsubject={Mathematics, Foundations, Set Theory, Analysis},
    pdfkeywords={mathematics, set theory, real analysis, foundations, Bourbaki}
]{hyperref}
\usepackage[most]{tcolorbox} % For the cool gray boxes
\usepackage{enumitem} % Better list control
\usepackage{mathtools} % Extended math tools
\usepackage{newunicodechar} % For unicode symbols
\newunicodechar{✓}{\checkmark}
\newunicodechar{✗}{\texttimes}
\usepackage{tikz} % For diagrams
\usetikzlibrary{arrows.meta, positioning, shadows} % For arrow styles and shadows
\usepackage{pgfplots} % For plots
\pgfplotsset{compat=1.18}

% --- TikZ Arrow Style Standardization ---
\tikzset{
    arrow/.style={->, thick},
    double arrow/.style={<->, thick},
    thick arrow/.style={->, very thick},
    ultra arrow/.style={->, ultra thick}
}
\usetikzlibrary{
    arrows.meta,
    positioning,
    shapes.geometric,
    shapes.misc,
    calc,
    decorations.pathreplacing,
    decorations.markings,
    fit,
    backgrounds
}
\usepackage{makeidx} % For index generation

\geometry{a4paper, margin=1in}

% Better spacing and layout control
\setlength{\parskip}{0.3em}
\setlength{\abovedisplayskip}{12pt plus 3pt minus 9pt}
\setlength{\belowdisplayskip}{12pt plus 3pt minus 9pt}
\setlength{\abovedisplayshortskip}{0pt plus 3pt}
\setlength{\belowdisplayshortskip}{7pt plus 3pt minus 4pt}

\makeindex % Enable index generation

% --- 2. CUSTOM DEFINITIONS (The "Style") ---

% Global TikZ Color Palette (for consistency across all diagrams)
\definecolor{diagramBlue}{HTML}{4A90E2}      % Primary diagram color
\definecolor{diagramLightBlue}{HTML}{E3F2FD} % Light fill for nodes
\definecolor{diagramRed}{HTML}{E74C3C}       % Emphasis/warning
\definecolor{diagramGreen}{HTML}{27AE60}     % Success/positive
\definecolor{diagramGray}{HTML}{95A5A6}      % Neutral/secondary

% The "Historical Note" Box (Gray background)
\definecolor{historyBg}{HTML}{E8E8E8}
\definecolor{historyFrame}{HTML}{555555}

\newtcolorbox{historicalnote}[1][]{
  colback=historyBg,
  colframe=historyFrame,
  fonttitle=\bfseries,
  title=Historical Context,
  sharp corners=south,
  breakable,
  #1
}

% The "Remark" Box (Light blue)
\definecolor{remarkBg}{HTML}{E3F2FD}
\definecolor{remarkFrame}{HTML}{1976D2}

\newtcolorbox{remark}[1][Remark]{
  colback=remarkBg,
  colframe=remarkFrame,
  fonttitle=\bfseries,
  title=#1,
  sharp corners=south,
  breakable
}

% The "Warning" Box (Light red)
\definecolor{warningBg}{HTML}{FFEBEE}
\definecolor{warningFrame}{HTML}{C62828}

\newtcolorbox{warning}[1][]{
  colback=warningBg,
  colframe=warningFrame,
  fonttitle=\bfseries,
  title=Warning,
  sharp corners=south,
  breakable,
  #1
}

% The "Intuition" Box (Light green)
\definecolor{intuitionBg}{HTML}{E8F5E9}
\definecolor{intuitionFrame}{HTML}{388E3C}

\newtcolorbox{intuition}[1][]{
  colback=intuitionBg,
  colframe=intuitionFrame,
  fonttitle=\bfseries,
  title=Intuition,
  sharp corners=south,
  breakable,
  #1
}

% The "Key Idea" Box (Light yellow)
\definecolor{keyideaBg}{HTML}{FFF9C4}
\definecolor{keyideaFrame}{HTML}{F57F17}

\newtcolorbox{keyidea}[1][]{
  colback=keyideaBg,
  colframe=keyideaFrame,
  fonttitle=\bfseries,
  title=Key Idea,
  sharp corners=south,
  breakable,
  #1
}

% The Math Environments
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}{Definition}[chapter]
\newtheorem{axiom}{Axiom}[chapter]
\newtheorem{example}{Example}[chapter]
\newtheorem*{notation}{Notation}

% Proof environment customization
\renewcommand{\qedsymbol}{$\blacksquare$}

% --- 3. TITLE INFO ---
\title{\textbf{Foundations of Mathematics} \\ 
       \large A Rigorous Development in the Style of Bourbaki \\
       \vspace{0.5cm}
       \large The Collins Compendium --- Formal Edition}
\author{Collins Mwangi}
\date{\today}

% --- 4. THE DOCUMENT ---
\begin{document}

\frontmatter

% Custom Cover Page
\begin{titlepage}
\begin{tikzpicture}[remember picture,overlay]
    % Background gradient effect with geometric pattern
    \fill[blue!5] (current page.south west) rectangle (current page.north east);
    
    % Decorative geometric pattern - top right
    \foreach \i in {0,1,...,8} {
        \draw[blue!20, line width=0.5pt] (current page.north east) ++(-\i cm, -\i cm) 
            -- ++(-6+\i*0.3,0) -- ++(0,-6+\i*0.3);
    }
    
    % Decorative geometric pattern - bottom left
    \foreach \i in {0,1,...,8} {
        \draw[blue!20, line width=0.5pt] (current page.south west) ++(\i cm, \i cm) 
            -- ++(6-\i*0.3,0) -- ++(0,6-\i*0.3);
    }
    
    % Mathematical symbols pattern (subtle background)
    \node[opacity=0.03, scale=15] at ([xshift=3cm, yshift=-3cm]current page.center) 
        {$\int \sum \prod \forall \exists$};
    
    % Central content box
    \node[
        rectangle,
        draw=blue!60,
        line width=2pt,
        rounded corners=3pt,
        inner sep=20pt,
        fill=white,
        drop shadow={opacity=0.2, shadow xshift=3pt, shadow yshift=-3pt}
    ] at (current page.center) {
        \begin{minipage}{0.7\textwidth}
            \centering
            
            % Decorative top line
            \tikz{\draw[blue!60, line width=1.5pt] (0,0) -- (8,0);}
            
            \vspace{1cm}
            
            % Main Title
            {\Huge\bfseries\color{blue!70} FOUNDATIONS OF}
            
            \vspace{0.3cm}
            
            {\Huge\bfseries\color{blue!70} MATHEMATICS}
            
            \vspace{1cm}
            
            % Subtitle
            {\Large\itshape A Rigorous Development}
            
            {\Large\itshape in the Style of Bourbaki}
            
            \vspace{1.5cm}
            
            % Mathematical diagram - symbolic representation
            \begin{tikzpicture}[scale=0.8]
                % Set theory foundation
                \draw[thick, blue!60] (0,0) circle (1.5cm);
                \node at (0,0) {$\mathbb{N}$};
                \draw[thick, blue!60] (0,0) circle (2cm);
                \node at (0,1.7) {$\mathbb{Z}$};
                \draw[thick, blue!60] (0,0) circle (2.5cm);
                \node at (0,2.2) {$\mathbb{Q}$};
                \draw[thick, blue!60] (0,0) circle (3cm);
                \node at (0,2.7) {$\mathbb{R}$};
                
                % Arrows showing progression
                \draw[->, thick, blue!80] (3.5,0) -- (5,0);
                \node at (5.5,0) {$\mathbb{C}$};
            \end{tikzpicture}
            
            \vspace{1.5cm}
            
            {\large \textbf{The Collins Compendium}}
            
            {\large Formal Edition}
            
            \vspace{1cm}
            
            % Decorative bottom line
            \tikz{\draw[blue!60, line width=1.5pt] (0,0) -- (8,0);}
            
            \vspace{0.5cm}
            
            % Author
            {\Large\textsc{Collins Mwangi}}
            
            \vspace{0.5cm}
            
            {\large \today}
            
        \end{minipage}
    };
    
    % Bottom decorative mathematical quote
    \node[text width=0.6\textwidth, align=center, color=blue!60] 
        at ([yshift=1.5cm]current page.south) {
        \small\itshape ``Mathematics is the art of giving the same name to different things'' \\
        — Henri Poincaré
    };
    
\end{tikzpicture}
\end{titlepage}

% Blank page (standard practice)
\clearpage
\thispagestyle{empty}
\mbox{}
\clearpage

% Title page (simpler, formal version)
\thispagestyle{empty}
\begin{center}
    \vspace*{3cm}
    
    {\Huge\bfseries Foundations of Mathematics}
    
    \vspace{1cm}
    
    {\Large A Rigorous Development in the Style of Bourbaki}
    
    \vspace{2cm}
    
    {\LARGE Collins Mwangi}
    
    \vfill
    
    {\large The Collins Compendium --- Formal Edition}
    
    \vspace{0.5cm}
    
    {\large \today}
    
    \vspace{1cm}
\end{center}
\clearpage

% Copyright/Publication page
\thispagestyle{empty}
\vspace*{\fill}
\begin{flushleft}
    \textbf{Foundations of Mathematics: A Rigorous Development in the Style of Bourbaki}
    
    \vspace{0.5cm}
    
    Copyright \copyright\ \the\year\ Collins Mwangi
    
    \vspace{0.5cm}
    
    \textit{The Collins Compendium --- Formal Edition}
    
    \vspace{1cm}
    
    All rights reserved. No part of this publication may be reproduced, distributed, or transmitted in any form or by any means, including photocopying, recording, or other electronic or mechanical methods, without the prior written permission of the author, except in the case of brief quotations embodied in critical reviews and certain other noncommercial uses permitted by copyright law.
    
    \vspace{1cm}
    
    \textbf{First Edition:} \today
    
    \vspace{0.5cm}
    
    Typeset in \LaTeX
    
    \vspace{0.5cm}
    
    \textbf{Contact:} For permissions or inquiries, please contact the author.
    
    \vspace{1cm}
    
    \textit{Dedicated to all who seek truth through rigorous reasoning.}
    
\end{flushleft}
\vspace*{\fill}
\clearpage

% Optional: Dedication page (you can customize or remove this)
\thispagestyle{empty}
\vspace*{0.35\textheight}
\begin{center}
    \textit{To my family, teachers, and the mathematical giants \\
    upon whose shoulders we stand.}
    
    \vspace{1cm}
    
    \textit{``God made the integers; all else is the work of man.''} \\
    --- Leopold Kronecker
\end{center}
\clearpage

% Blank page before preface
\thispagestyle{empty}
\mbox{}
\clearpage

\chapter*{Preface}
\addcontentsline{toc}{chapter}{Preface}

This work presents a rigorous, axiomatic treatment of the foundations of mathematics, following the spirit of Nicolas Bourbaki's \textit{Éléments de mathématique}. However, unlike Bourbaki's austere presentation, we take a \textit{pedagogical approach}: every concept is introduced gradually, building on what came before.

\textbf{Philosophy:} Mathematics is not discovered; it is constructed. Every theorem flows from axioms through rigorous logical deduction. But before the formalism, we provide \textit{intuition}. Before the proof, we explain the \textit{key idea}. Before the definition, we motivate \textit{why we need it}.

\textbf{Structure:} This book is designed to be read linearly. Each chapter builds on previous foundations:
\begin{enumerate}
    \item \textbf{Foundations}: We start informally, explaining what mathematics \textit{is} and why we need axioms
    \item \textbf{Formal Logic}: The simplest formal system---propositional and predicate logic with complete proofs
    \item \textbf{Axiomatic Set Theory}: Building the universe of mathematics from the ZFC axioms
    \item \textbf{Arithmetic}: Recursive operations on natural numbers and construction of integers and rationals
    \item \textbf{Relations}: Ordered pairs, Cartesian products, equivalence relations, and partial orders
    \item \textbf{Functions}: The morphisms of mathematics---injections, surjections, bijections, and composition
    \item \textbf{Cardinality}: Measuring infinite sets---Cantor's diagonal argument and the hierarchy of infinities
    \item \textbf{The Real Numbers}: Dedekind cuts, completeness, and filling the gaps in the rationals
    \item \textbf{Sequences and Convergence}: Limits, Cauchy sequences, and the foundation of analysis
    \item \textbf{Continuity}: The $\epsilon$-$\delta$ definition, IVT, EVT, and uniform continuity
    \item \textbf{Differentiation}: Derivatives as limits, MVT, and the algebra of differentiation
    \item \textbf{Integration}: Riemann sums, the Fundamental Theorem, and applications to area and volume
\end{enumerate}

Each concept follows this pattern:
\begin{center}
\textbf{Intuition} $\to$ \textbf{Motivation} $\to$ \textbf{Formal Definition} $\to$ \textbf{Examples} $\to$ \textbf{Theorems} $\to$ \textbf{Proofs}
\end{center}

We use color-coded boxes to guide your reading:
\begin{itemize}
    \item \textcolor{intuitionFrame}{\textbf{Green boxes}}: Informal intuition before formal definitions
    \item \textcolor{keyideaFrame}{\textbf{Yellow boxes}}: Key ideas before complex proofs
    \item \textcolor{remarkFrame}{\textbf{Blue boxes}}: Technical remarks and connections
    \item \textcolor{warningFrame}{\textbf{Red boxes}}: Common pitfalls and misconceptions
    \item \textcolor{historyFrame}{\textbf{Gray boxes}}: Historical context and motivation
\end{itemize}

\textbf{Prerequisites:} Curiosity and patience. We assume no prior formal training, but we do not compromise on rigor. Every step is justified. Every proof is complete.

\textbf{Regarding Historical Notes:} Throughout this book, historical context appears within chapters, not at the end. This is intentional---understanding the historical development of concepts provides crucial insight into \textit{why} definitions are structured as they are and what problems they solve. Mathematics is not timeless abstraction; it evolved through human struggle with deep questions.

\vspace{1cm}
\noindent \textit{``In mathematics, we never know what we are talking about, nor whether what we are saying is true\@.''} \\
\hfill --- Bertrand Russell

\clearpage
\section*{Chapter Dependencies}
\addcontentsline{toc}{section}{Chapter Dependencies}

The following diagram shows the logical dependencies between chapters. An arrow from A to B means that chapter A must be understood before chapter B.

\vspace{1cm}
\begin{center}
\begin{tikzpicture}[scale=0.9,
    chapter/.style={rectangle, draw, fill=blue!20, text width=3cm, align=center, minimum height=1cm, rounded corners},
    arrow/.style={->, >=stealth, thick}
]
    % Row 1: Foundation
    \node[chapter] (found) at (5, 10) {1. Foundations};
    
    % Row 2: Logic and Sets
    \node[chapter] (logic) at (2, 8) {2. Logic};
    \node[chapter] (sets) at (8, 8) {3. Set Theory};
    
    % Row 3: Basic structures
    \node[chapter] (arith) at (2, 6) {4. Arithmetic};
    \node[chapter] (rel) at (5, 6) {5. Relations};
    \node[chapter] (func) at (8, 6) {6. Functions};
    
    % Row 4: Cardinality and Reals
    \node[chapter] (card) at (3.5, 4) {7. Cardinality};
    \node[chapter] (real) at (6.5, 4) {8. Real Numbers};
    
    % Row 5: Analysis begins
    \node[chapter] (seq) at (5, 2) {9. Sequences};
    
    % Row 6: Calculus
    \node[chapter] (cont) at (2, 0) {10. Continuity};
    \node[chapter] (diff) at (5, 0) {11. Differentiation};
    \node[chapter] (int) at (8, 0) {12. Integration};
    
    % Dependencies
    \draw[arrow] (found) -- (logic);
    \draw[arrow] (found) -- (sets);
    \draw[arrow] (logic) -- (sets);
    \draw[arrow] (sets) -- (arith);
    \draw[arrow] (sets) -- (rel);
    \draw[arrow] (sets) -- (func);
    \draw[arrow] (rel) -- (func);
    \draw[arrow] (arith) -- (real);
    \draw[arrow] (func) -- (card);
    \draw[arrow] (func) -- (real);
    \draw[arrow] (card) -- (real);
    \draw[arrow] (real) -- (seq);
    \draw[arrow] (seq) -- (cont);
    \draw[arrow] (seq) -- (diff);
    \draw[arrow] (seq) -- (int);
    \draw[arrow] (cont) -- (diff);
    \draw[arrow] (diff) -- (int);
\end{tikzpicture}
\end{center}

\textbf{Reading suggestion:} Follow the order presented. Each chapter assumes complete understanding of all chapters it depends upon.

\clearpage
\section*{Notation and Symbols}
\addcontentsline{toc}{section}{Notation and Symbols}

\textbf{Logic and Set Theory:}
\begin{itemize}[leftmargin=3cm, labelsep=0.5cm]
    \item[$\neg$] Logical negation (NOT)
    \item[$\land$] Logical conjunction (AND)
    \item[$\lor$] Logical disjunction (OR)
    \item[$\implies$] Logical implication (IF...THEN)
    \item[$\iff$] Logical bi-conditional (IF AND ONLY IF)
    \item[$\forall$] Universal quantifier (FOR ALL)
    \item[$\exists$] Existential quantifier (THERE EXISTS)
    \item[$\in$] Set membership (IS AN ELEMENT OF)
    \item[$\notin$] Not a member of
    \item[$\subseteq$] Subset or equal
    \item[$\subset$] Proper subset
    \item[$\emptyset$] Empty set
    \item[$\cup$] Set union
    \item[$\cap$] Set intersection
    \item[$\setminus$] Set difference
    \item[$A^c$] Complement of set $A$
    \item[$\mathcal{P}(A)$] Power set (set of all subsets of $A$)
    \item[$A \times B$] Cartesian product
    \item[$|A|$] Cardinality (size) of set $A$
\end{itemize}

\textbf{Number Systems:}
\begin{itemize}[leftmargin=3cm, labelsep=0.5cm]
    \item[$\mathbb{N}$] Natural numbers $\{0, 1, 2, 3, \ldots\}$
    \item[$\mathbb{Z}$] Integers $\{\ldots, -2, -1, 0, 1, 2, \ldots\}$
    \item[$\mathbb{Q}$] Rational numbers
    \item[$\mathbb{R}$] Real numbers
    \item[$\mathbb{C}$] Complex numbers (not covered in this volume)
    \item[$\aleph_0$] Cardinality of natural numbers (``aleph-null'')
\end{itemize}

\textbf{Relations and Functions:}
\begin{itemize}[leftmargin=3cm, labelsep=0.5cm]
    \item[$f: A \to B$] Function from $A$ to $B$
    \item[$f(x)$] Value of function $f$ at $x$
    \item[$f \circ g$] Composition of functions
    \item[$f^{-1}$] Inverse function
    \item[$\text{dom}(f)$] Domain of function
    \item[$\text{Im}(f)$] Image (range) of function
    \item[${[}x{]}$] Equivalence class of $x$
    \item[$A/\!\!\sim$] Quotient set (set of equivalence classes)
    \item[$\le, <$] Less than or equal, strictly less than
    \item[$\ge, >$] Greater than or equal, strictly greater than
\end{itemize}

\textbf{Analysis:}
\begin{itemize}[leftmargin=3cm, labelsep=0.5cm]
    \item[$|x|$] Absolute value
    \item[$\lim_{n \to \infty} a_n$] Limit of sequence $(a_n)$
    \item[$\lim_{x \to c} f(x)$] Limit of function at $c$
    \item[$f'(x)$] Derivative of $f$
    \item[$\frac{df}{dx}$] Derivative (Leibniz notation)
    \item[$\int_a^b f(x) \, dx$] Definite integral from $a$ to $b$
    \item[$\epsilon$] Small positive number (epsilon)
    \item[$\delta$] Small positive number (delta)
    \item[$\sup A$] Supremum (least upper bound)
    \item[$\inf A$] Infimum (greatest lower bound)
\end{itemize}

\textbf{Proof Terminology:}
\begin{itemize}[leftmargin=3cm, labelsep=0.5cm]
    \item[QED] ``Quod erat demonstrandum'' (which was to be demonstrated)
    \item[$\square$] End of proof marker
    \item[$\checkmark$] Verified/confirmed
    \item[IH] Inductive Hypothesis
\end{itemize}

\tableofcontents

\mainmatter%

% Include chapters
\include{chapters/foundations}
\include{chapters/logic}
\include{chapters/sets}
\include{chapters/relations}
\include{chapters/arithmetic}
\include{chapters/functions}
\include{chapters/cardinality}
\include{chapters/real_numbers}
\include{chapters/sequences}
\include{chapters/continuity}
\include{chapters/differentiation}
\include{chapters/integration}
% Statistics chapter omitted - to be developed in future volume
% \include{chapters/statistics}

% Index
\cleardoublepage
\phantomsection
\addcontentsline{toc}{chapter}{Index}
\printindex

% Back Cover
\clearpage
\thispagestyle{empty}
\pagecolor{blue!5}
\begin{tikzpicture}[remember picture,overlay]
    % Decorative geometric pattern - top
    \foreach \i in {0,1,...,8} {
        \draw[blue!20, line width=0.5pt] (current page.north west) ++(\i cm, -\i cm) 
            -- ++(6-\i*0.3,0) -- ++(0,-6+\i*0.3);
    }
    
    % Decorative geometric pattern - bottom
    \foreach \i in {0,1,...,8} {
        \draw[blue!20, line width=0.5pt] (current page.south east) ++(-\i cm, \i cm) 
            -- ++(-6+\i*0.3,0) -- ++(0,6-\i*0.3);
    }
    
    % Main content box
    \node[
        rectangle,
        draw=blue!60,
        line width=2pt,
        rounded corners=3pt,
        inner sep=20pt,
        fill=white,
        text width=0.8\textwidth,
        drop shadow={opacity=0.2, shadow xshift=3pt, shadow yshift=-3pt}
    ] at (current page.center) {
        \begin{center}
            {\Large\bfseries\color{blue!70} About This Book}
        \end{center}
        
        \vspace{0.5cm}
        
        \textit{Foundations of Mathematics} presents a complete, rigorous construction of mathematics from first principles. Beginning with formal logic and axiomatic set theory, this text builds the number systems (ℕ, ℤ, ℚ, ℝ), develops the foundations of analysis, and proves the fundamental theorems of calculus.
        
        \vspace{0.5cm}
        
        Written in the spirit of Bourbaki but with modern pedagogical clarity, each concept is motivated intuitively before formal definitions. The text includes:
        
        \begin{itemize}
            \item Complete ZFC axioms with detailed explanations
            \item Rigorous proofs of all major theorems (MVT, FTC, IVT, EVT, Cantor's diagonal argument)
            \item Color-coded exposition: intuition boxes, key ideas, warnings, and historical notes
            \item Comprehensive coverage from foundations through integration
            \item TikZ diagrams throughout for visual clarity
        \end{itemize}
        
        \vspace{0.5cm}
        
        \textbf{Suitable for:} Advanced undergraduates, graduate students, and anyone seeking a complete, rigorous understanding of mathematical foundations.
        
        \vspace{0.5cm}
        
        \begin{center}
            \tikz{\draw[blue!60, line width=1pt] (0,0) -- (10,0);}
        \end{center}
        
        \vspace{0.3cm}
        
        \begin{center}
            {\large\textbf{The Collins Compendium}}
            
            {\large Formal Edition}
            
            \vspace{0.3cm}
            
            {\textit{Building Mathematics from the Ground Up}}
        \end{center}
    };
    
    % Footer
    \node[text width=0.6\textwidth, align=center, color=blue!60] 
        at ([yshift=1.5cm]current page.south) {
        \small Typeset in \LaTeX\ \ $\bullet$ \ \textbf{Collins Mwangi} \ $\bullet$ \ \the\year
    };
    
\end{tikzpicture}

\end{document}